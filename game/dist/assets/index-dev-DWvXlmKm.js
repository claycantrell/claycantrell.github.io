import{L as e,F as t,S as s,E as n,T as i}from"./three-DiX2_aTt.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();let r=class{constructor(e=Math){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(let t=0;t<256;t++)this.p[t]=Math.floor(256*e.random());this.perm=[];for(let t=0;t<512;t++)this.perm[t]=this.p[255&t];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}dot(e,t,s){return e[0]*t+e[1]*s}dot3(e,t,s,n){return e[0]*t+e[1]*s+e[2]*n}dot4(e,t,s,n,i){return e[0]*t+e[1]*s+e[2]*n+e[3]*i}noise(e,t){let s,n,i;const r=(e+t)*(.5*(Math.sqrt(3)-1)),o=Math.floor(e+r),a=Math.floor(t+r),l=(3-Math.sqrt(3))/6,c=(o+a)*l,d=e-(o-c),h=t-(a-c);let m,u;d>h?(m=1,u=0):(m=0,u=1);const p=d-m+l,g=h-u+l,y=d-1+2*l,f=h-1+2*l,j=255&o,w=255&a,b=this.perm[j+this.perm[w]]%12,M=this.perm[j+m+this.perm[w+u]]%12,E=this.perm[j+1+this.perm[w+1]]%12;let v=.5-d*d-h*h;v<0?s=0:(v*=v,s=v*v*this.dot(this.grad3[b],d,h));let T=.5-p*p-g*g;T<0?n=0:(T*=T,n=T*T*this.dot(this.grad3[M],p,g));let x=.5-y*y-f*f;return x<0?i=0:(x*=x,i=x*x*this.dot(this.grad3[E],y,f)),70*(s+n+i)}noise3d(e,t,s){let n,i,r,o;const a=(e+t+s)*(1/3),l=Math.floor(e+a),c=Math.floor(t+a),d=Math.floor(s+a),h=1/6,m=(l+c+d)*h,u=e-(l-m),p=t-(c-m),g=s-(d-m);let y,f,j,w,b,M;u>=p?p>=g?(y=1,f=0,j=0,w=1,b=1,M=0):u>=g?(y=1,f=0,j=0,w=1,b=0,M=1):(y=0,f=0,j=1,w=1,b=0,M=1):p<g?(y=0,f=0,j=1,w=0,b=1,M=1):u<g?(y=0,f=1,j=0,w=0,b=1,M=1):(y=0,f=1,j=0,w=1,b=1,M=0);const E=u-y+h,v=p-f+h,T=g-j+h,x=u-w+2*h,C=p-b+2*h,k=g-M+2*h,L=u-1+.5,S=p-1+.5,P=g-1+.5,B=255&l,q=255&c,I=255&d,A=this.perm[B+this.perm[q+this.perm[I]]]%12,N=this.perm[B+y+this.perm[q+f+this.perm[I+j]]]%12,O=this.perm[B+w+this.perm[q+b+this.perm[I+M]]]%12,z=this.perm[B+1+this.perm[q+1+this.perm[I+1]]]%12;let F=.6-u*u-p*p-g*g;F<0?n=0:(F*=F,n=F*F*this.dot3(this.grad3[A],u,p,g));let W=.6-E*E-v*v-T*T;W<0?i=0:(W*=W,i=W*W*this.dot3(this.grad3[N],E,v,T));let D=.6-x*x-C*C-k*k;D<0?r=0:(D*=D,r=D*D*this.dot3(this.grad3[O],x,C,k));let G=.6-L*L-S*S-P*P;return G<0?o=0:(G*=G,o=G*G*this.dot3(this.grad3[z],L,S,P)),32*(n+i+r+o)}noise4d(e,t,s,n){const i=this.grad4,r=this.simplex,o=this.perm,a=(Math.sqrt(5)-1)/4,l=(5-Math.sqrt(5))/20;let c,d,h,m,u;const p=(e+t+s+n)*a,g=Math.floor(e+p),y=Math.floor(t+p),f=Math.floor(s+p),j=Math.floor(n+p),w=(g+y+f+j)*l,b=e-(g-w),M=t-(y-w),E=s-(f-w),v=n-(j-w),T=(b>M?32:0)+(b>E?16:0)+(M>E?8:0)+(b>v?4:0)+(M>v?2:0)+(E>v?1:0),x=r[T][0]>=3?1:0,C=r[T][1]>=3?1:0,k=r[T][2]>=3?1:0,L=r[T][3]>=3?1:0,S=r[T][0]>=2?1:0,P=r[T][1]>=2?1:0,B=r[T][2]>=2?1:0,q=r[T][3]>=2?1:0,I=r[T][0]>=1?1:0,A=r[T][1]>=1?1:0,N=r[T][2]>=1?1:0,O=r[T][3]>=1?1:0,z=b-x+l,F=M-C+l,W=E-k+l,D=v-L+l,G=b-S+2*l,H=M-P+2*l,$=E-B+2*l,_=v-q+2*l,R=b-I+3*l,U=M-A+3*l,X=E-N+3*l,J=v-O+3*l,K=b-1+4*l,V=M-1+4*l,Q=E-1+4*l,Y=v-1+4*l,Z=255&g,ee=255&y,te=255&f,se=255&j,ne=o[Z+o[ee+o[te+o[se]]]]%32,ie=o[Z+x+o[ee+C+o[te+k+o[se+L]]]]%32,re=o[Z+S+o[ee+P+o[te+B+o[se+q]]]]%32,oe=o[Z+I+o[ee+A+o[te+N+o[se+O]]]]%32,ae=o[Z+1+o[ee+1+o[te+1+o[se+1]]]]%32;let le=.6-b*b-M*M-E*E-v*v;le<0?c=0:(le*=le,c=le*le*this.dot4(i[ne],b,M,E,v));let ce=.6-z*z-F*F-W*W-D*D;ce<0?d=0:(ce*=ce,d=ce*ce*this.dot4(i[ie],z,F,W,D));let de=.6-G*G-H*H-$*$-_*_;de<0?h=0:(de*=de,h=de*de*this.dot4(i[re],G,H,$,_));let he=.6-R*R-U*U-X*X-J*J;he<0?m=0:(he*=he,m=he*he*this.dot4(i[oe],R,U,X,J));let me=.6-K*K-V*V-Q*Q-Y*Y;return me<0?u=0:(me*=me,u=me*me*this.dot4(i[ae],K,V,Q,Y)),27*(c+d+h+m+u)}};class o{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,t=100){const s=[],n=function(e,t,s){const n=Array.from(e),i=t/s.resolution,r=(s.boundingBox.yMax-s.boundingBox.yMin+s.underlineThickness)*i,o=[];let l=0,c=0;for(let d=0;d<n.length;d++){const e=n[d];if("\n"===e)l=0,c-=r;else{const t=a(e,i,l,c,s);l+=t.offsetX,o.push(t.path)}}return o}(e,t,this.data);for(let i=0,r=n.length;i<r;i++)s.push(...n[i].toShapes());return s}}function a(e,t,n,i,r){const o=r.glyphs[e]||r.glyphs["?"];if(!o)return;const a=new s;let l,c,d,h,m,u,p,g;if(o.o){const e=o._cachedOutline||(o._cachedOutline=o.o.split(" "));for(let s=0,r=e.length;s<r;){switch(e[s++]){case"m":l=e[s++]*t+n,c=e[s++]*t+i,a.moveTo(l,c);break;case"l":l=e[s++]*t+n,c=e[s++]*t+i,a.lineTo(l,c);break;case"q":d=e[s++]*t+n,h=e[s++]*t+i,m=e[s++]*t+n,u=e[s++]*t+i,a.quadraticCurveTo(m,u,d,h);break;case"b":d=e[s++]*t+n,h=e[s++]*t+i,m=e[s++]*t+n,u=e[s++]*t+i,p=e[s++]*t+n,g=e[s++]*t+i,a.bezierCurveTo(m,u,p,g,d,h)}}}return{offsetX:o.ha*t,path:a}}const l="localhost"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname;window.onerror=function(e,t,s,n,i){if(l){const e=document.getElementById("notification");e&&(e.textContent="An error occurred. Please refresh the page.",e.style.display="block")}return!1},window.onunhandledrejection=function(e){},window.gameLog=l?()=>{}:function(){}.bind();window.THREE={...i,FontLoader:class extends e{constructor(e){super(e)}load(e,s,n,i){const r=this,o=new t(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(e){const t=r.parse(JSON.parse(e));s&&s(t)},n,i)}parse(e){return new o(e)}},TextGeometry:class extends n{constructor(e,t={}){const s=t.font;if(void 0===s)super();else{const n=s.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),super(n,t)}this.type="TextGeometry"}}},window.SimplexNoise=class extends r{constructor(e){super("string"==typeof e?function(e){let t=0;for(let s=0;s<e.length;s++)t=Math.imul(31,t)+e.charCodeAt(s)|0;return{random:()=>(t=Math.imul(t^t>>>16,2246822507),t=Math.imul(t^t>>>13,3266489909),((t^=t>>>16)>>>0)/4294967296)}}(e):e)}noise2D(e,t){return this.noise(e,t)}},window.THREE_MODULES_LOADED=!0,window.dispatchEvent(new Event("threeModulesLoaded"));const c=["./engine/namespace.js","./engine/systems.js","./engine/config.js","./engine/performance.js","./engine/utils/random.js","./engine/utils/entity-config.js","./engine/utils/collision.js","./engine/utils/terrain.js","./engine/utils/behaviors.js","./engine/utils/entity-factory.js","./engine/utils/animal-behaviors.js","./engine/utils/animation-utils.js","./maps/map-loader.js","./systems/character.js","./systems/climate.js","./systems/sky.js","./systems/biomes.js","./engine/utils/ground-textures.js","./systems/water.js","./systems/chunks.js","./systems/terrain.js","./systems/trees.js","./systems/shrubs.js","./systems/portals.js","./systems/entities/npc.js","./systems/entities/deer.js","./systems/entities/cow.js","./systems/entities/bunny.js","./systems/entities/bird.js","./systems/entities/entity-registry.js","./systems/entities/animal-spawner.js","./multiplayer/player-utils.js","./multiplayer/time-sync.js","./multiplayer/sync.js","./engine/input.js","./engine/audio.js","./engine/ui.js","./systems/chat.js","./multiplayer/client.js","./multiplayer/other-players.js","./systems/building.js","./systems/terraform.js","./maps/map-menu.js","./engine/core.js","./engine/game.js"],d=document.getElementById("loading-bar"),h=document.getElementById("loading-percent"),m=document.getElementById("loading-status"),u=document.getElementById("loading-screen");function p(e,t){d&&(d.style.width=`${e}%`),h&&(h.textContent=`${Math.round(e)}%`),m&&(m.textContent=t)}function g(e,t=1e4){return new Promise((s,n)=>{const i=document.createElement("script");i.src=e;const r=setTimeout(()=>{n(new Error(`Script load timeout: ${e}`))},t);i.onload=()=>{clearTimeout(r),s()},i.onerror=()=>{clearTimeout(r),n(new Error(`Failed to load script: ${e}`))},document.body.appendChild(i)})}function y(e){const t=e.split("/").pop().replace(".js","");return{namespace:"Core systems",systems:"Game systems",config:"Configuration",performance:"Performance settings",random:"World generation","entity-config":"Entity configuration",collision:"Collision utilities",terrain:"Terrain utilities",behaviors:"Entity behaviors","map-loader":"Map loader",character:"Character system",climate:"Climate system",biomes:"Biome data","ground-textures":"Ground textures",water:"Water system",caves:"Cave generation",chunks:"Terrain chunks",terrain:"Terrain generation",trees:"Tree generation",shrubs:"Vegetation",portals:"Portal system",npc:"NPC system",deer:"Wildlife (deer)",bunny:"Wildlife (bunnies)",bird:"Wildlife (birds)","entity-registry":"Entity registry","animal-spawner":"Animal spawner","player-utils":"Multiplayer utilities","time-sync":"Time synchronization",sync:"Network sync",input:"Input controls",audio:"Audio system",ui:"User interface",chat:"Chat system",client:"Network client","other-players":"Multiplayer rendering",building:"Building system",terraform:"Terraforming","map-menu":"Map selection",core:"Initializing world",game:"Starting game"}[t]||t}window.hideLoadingScreen=function(){u&&u.classList.add("hidden")},window.updateLoadingProgress=p,async function(){const e=c.length;try{for(let t=0;t<c.length;t++){const s=c[t];p(t/e*90,y(s)),await g(s)}p(95,"Finalizing"),gameLog("All game scripts loaded")}catch(t){p(0,"Error loading game");const e=document.getElementById("notification");e&&(e.textContent="Failed to load game. Please refresh the page.",e.style.display="block",e.style.background="rgba(200, 0, 0, 0.8)")}}();
